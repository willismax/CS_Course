<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊºîÁÆóÊ≥ïË¶ñË¶∫ÂåñÂ∑•ÂÖ∑</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 30px;
            font-size: 2.5rem;
        }
        
        .algorithm-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }
        
        .algo-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            background: #4299e1;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .algo-btn:hover {
            background: #3182ce;
            transform: translateY(-2px);
        }
        
        .algo-btn.active {
            background: #38a169;
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #f7fafc;
            border-radius: 15px;
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            background: #48bb78;
            color: white;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .control-btn:hover {
            background: #38a169;
        }
        
        .control-btn:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }
        
        input[type="range"] {
            width: 120px;
        }
        
        .visualization-area {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .array-container {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .array-element {
            width: 50px;
            height: 50px;
            background: #4299e1;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .array-element.comparing {
            background: #f56565;
            transform: scale(1.1);
        }
        
        .array-element.swapping {
            background: #ed8936;
            transform: scale(1.2);
            z-index: 10;
            position: relative;
        }
        
        .array-element.moving-up {
            animation: moveUp 0.6s ease-in-out;
            z-index: 15;
        }
        
        .array-element.moving-down {
            animation: moveDown 0.6s ease-in-out;
            z-index: 15;
        }
        
        @keyframes moveUp {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-60px); }
            100% { transform: translateY(0px); }
        }
        
        @keyframes moveDown {
            0% { transform: translateY(0px); }
            50% { transform: translateY(60px); }
            100% { transform: translateY(0px); }
        }
        
        .array-element.slide-left {
            animation: slideLeft 0.8s ease-in-out;
            z-index: 12;
        }
        
        .array-element.slide-right {
            animation: slideRight 0.8s ease-in-out;
            z-index: 12;
        }
        
        @keyframes slideLeft {
            0% { transform: translateX(0px); }
            50% { transform: translateX(-55px) translateY(-30px) scale(1.1); }
            100% { transform: translateX(0px); }
        }
        
        @keyframes slideRight {
            0% { transform: translateX(0px); }
            50% { transform: translateX(55px) translateY(-30px) scale(1.1); }
            100% { transform: translateX(0px); }
        }
        
        .array-element.sorted {
            background: #48bb78;
        }
        
        .array-element.pivot {
            background: #9f7aea;
            transform: scale(1.15);
        }
        
        .info-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 5px solid #4299e1;
        }
        
        .step-info {
            font-size: 16px;
            margin-bottom: 10px;
            color: #2d3748;
        }
        
        .complexity-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .complexity-card {
            background: #edf2f7;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .fibonacci-container {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .fib-input {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            width: 100px;
            text-align: center;
        }
        
        .fib-result {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
        }
        
        .fib-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            width: 100%;
            max-width: 600px;
        }
        
        .fib-method {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }
        
        .search-container {
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }
        
        .search-input {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            width: 100px;
            text-align: center;
        }
        
        .search-result {
            font-size: 18px;
            font-weight: bold;
            color: #2d3748;
        }
        
        .code-panel {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 5px solid #9f7aea;
        }
        
        .code-panel h2 {
            margin-top: 0;
            color: #4a5568;
            text-align: center;
        }
        
        .language-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }
        
        .tab-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            background: #e2e8f0;
            color: #4a5568;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .tab-btn:hover {
            background: #cbd5e0;
        }
        
        .tab-btn.active {
            background: #9f7aea;
            color: white;
        }
        
        .code-content {
            background: #2d3748;
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
        }
        
        .code-content pre {
            margin: 0;
            color: #e2e8f0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .code-content code {
            color: #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç ÊºîÁÆóÊ≥ïË¶ñË¶∫ÂåñÂ∑•ÂÖ∑</h1>
        
        <div class="algorithm-selector">
            <button class="algo-btn active" onclick="selectAlgorithm('selection')">ÈÅ∏ÊìáÊéíÂ∫è</button>
            <button class="algo-btn" onclick="selectAlgorithm('insertion')">ÊèíÂÖ•ÊéíÂ∫è</button>
            <button class="algo-btn" onclick="selectAlgorithm('bubble')">Ê≥°Ê≤´ÊéíÂ∫è</button>
            <button class="algo-btn" onclick="selectAlgorithm('quick')">Âø´ÈÄüÊéíÂ∫è</button>
            <button class="algo-btn" onclick="selectAlgorithm('binary')">‰∫åÂÖÉÊêúÂ∞ã</button>
            <button class="algo-btn" onclick="selectAlgorithm('fibonacci')">ÂãïÊÖãË¶èÂäÉ (Fibonacci)</button>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <button class="control-btn" onclick="generateArray()">Áî¢ÁîüÊñ∞Èô£Âàó</button>
                <button class="control-btn" onclick="startSort()" id="startBtn">ÈñãÂßãÊéíÂ∫è</button>
                <button class="control-btn" onclick="pauseSort()" id="pauseBtn" style="display: none;">Êö´ÂÅú</button>
                <button class="control-btn" onclick="resetArray()">ÈáçÁΩÆ</button>
            </div>
            <div class="control-group">
                <label>Èô£ÂàóÂ§ßÂ∞è:</label>
                <input type="range" id="arraySize" min="5" max="20" value="10" onchange="generateArray()">
                <span id="sizeValue">10</span>
            </div>
            <div class="control-group">
                <label>ÈÄüÂ∫¶:</label>
                <input type="range" id="speed" min="50" max="1000" value="300">
                <span>ÊÖ¢ ‚Üê ‚Üí Âø´</span>
            </div>
        </div>
        
        <div class="visualization-area">
            <div class="array-container" id="arrayContainer"></div>
            
            <div class="search-container" id="searchContainer">
                <div class="control-group">
                    <label>ÊêúÂ∞ãÁõÆÊ®ô:</label>
                    <input type="number" class="search-input" id="searchTarget" placeholder="Ëº∏ÂÖ•Êï∏Â≠ó">
                    <button class="control-btn" onclick="startBinarySearch()">ÈñãÂßãÊêúÂ∞ã</button>
                </div>
                <div class="search-result" id="searchResult"></div>
            </div>
            
            <div class="fibonacci-container" id="fibonacciContainer">
                <div class="control-group">
                    <label>Ë®àÁÆó Fibonacci Êï∏ÂàóÁ¨¨</label>
                    <input type="number" class="fib-input" id="fibInput" value="10" min="1" max="40">
                    <label>È†Ö</label>
                    <button class="control-btn" onclick="calculateFibonacci()">Ë®àÁÆó</button>
                </div>
                <div class="fib-result" id="fibResult"></div>
                <div class="fib-comparison">
                    <div class="fib-method">
                        <h3>üêå ÈÅûËø¥ÊñπÊ≥ï</h3>
                        <div id="recursiveResult">ÊôÇÈñì: - ms<br>ÂëºÂè´Ê¨°Êï∏: -</div>
                    </div>
                    <div class="fib-method">
                        <h3>‚ö° ÂãïÊÖãË¶èÂäÉ</h3>
                        <div id="dpResult">ÊôÇÈñì: - ms<br>ÂëºÂè´Ê¨°Êï∏: -</div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="info-panel">
            <div class="step-info" id="stepInfo">ÈÅ∏Êìá‰∏ÄÂÄãÊºîÁÆóÊ≥ïÈñãÂßãË¶ñË¶∫Âåñ</div>
            <div class="complexity-info" id="complexityInfo"></div>
        </div>
        
        <div class="code-panel">
            <h2>üìù Á®ãÂºèÁ¢ºÁØÑ‰æã</h2>
            <div class="language-tabs">
                <button class="tab-btn active" onclick="showLanguage('python')">Python</button>
                <button class="tab-btn" onclick="showLanguage('c')">C</button>
                <button class="tab-btn" onclick="showLanguage('java')">Java</button>
            </div>
            <div class="code-content" id="codeContent">
                <pre><code id="codeDisplay"></code></pre>
            </div>
        </div>
    </div>

    <script>
        let array = [];
        let originalArray = [];
        let currentAlgorithm = 'selection';
        let isRunning = false;
        let isPaused = false;
        let shouldStop = false;
        let animationSpeed = 300;
        let currentLanguage = 'python';

        // Á®ãÂºèÁ¢ºÁØÑ‰æãË≥áÊñôÂ∫´
        const codeExamples = {
            selection: {
                python: `def selection_sort(arr):
    """ÈÅ∏ÊìáÊéíÂ∫èÊ≥ï - Python ÂØ¶‰Ωú"""
    n = len(arr)
    
    for i in range(n - 1):
        # ÊâæÂà∞ÊúÄÂ∞èÂÄºÁöÑÁ¥¢Âºï
        min_idx = i
        for j in range(i + 1, n):
            if arr[j] < arr[min_idx]:
                min_idx = j
        
        # ‰∫§ÊèõÂÖÉÁ¥†
        arr[i], arr[min_idx] = arr[min_idx], arr[i]
    
    return arr

# ‰ΩøÁî®ÁØÑ‰æã
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = selection_sort(numbers.copy())
print(f"ÊéíÂ∫èÂâç: {numbers}")
print(f"ÊéíÂ∫èÂæå: {sorted_numbers}")`,
                c: `#include <stdio.h>

void selection_sort(int arr[], int n) {
    /* ÈÅ∏ÊìáÊéíÂ∫èÊ≥ï - C ÂØ¶‰Ωú */
    int i, j, min_idx, temp;
    
    for (i = 0; i < n - 1; i++) {
        // ÊâæÂà∞ÊúÄÂ∞èÂÄºÁöÑÁ¥¢Âºï
        min_idx = i;
        for (j = i + 1; j < n; j++) {
            if (arr[j] < arr[min_idx]) {
                min_idx = j;
            }
        }
        
        // ‰∫§ÊèõÂÖÉÁ¥†
        temp = arr[min_idx];
        arr[min_idx] = arr[i];
        arr[i] = temp;
    }
}

int main() {
    int arr[] = {64, 34, 25, 12, 22, 11, 90};
    int n = sizeof(arr) / sizeof(arr[0]);
    
    printf("ÊéíÂ∫èÂâç: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    selection_sort(arr, n);
    
    printf("\\nÊéíÂ∫èÂæå: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    return 0;
}`,
                java: `public class SelectionSort {
    /**
     * ÈÅ∏ÊìáÊéíÂ∫èÊ≥ï - Java ÂØ¶‰Ωú
     */
    public static void selectionSort(int[] arr) {
        int n = arr.length;
        
        for (int i = 0; i < n - 1; i++) {
            // ÊâæÂà∞ÊúÄÂ∞èÂÄºÁöÑÁ¥¢Âºï
            int minIdx = i;
            for (int j = i + 1; j < n; j++) {
                if (arr[j] < arr[minIdx]) {
                    minIdx = j;
                }
            }
            
            // ‰∫§ÊèõÂÖÉÁ¥†
            int temp = arr[minIdx];
            arr[minIdx] = arr[i];
            arr[i] = temp;
        }
    }
    
    public static void main(String[] args) {
        int[] numbers = {64, 34, 25, 12, 22, 11, 90};
        
        System.out.print("ÊéíÂ∫èÂâç: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
        
        selectionSort(numbers);
        
        System.out.print("\\nÊéíÂ∫èÂæå: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
    }
}`
            },
            insertion: {
                python: `def insertion_sort(arr):
    """ÊèíÂÖ•ÊéíÂ∫èÊ≥ï - Python ÂØ¶‰Ωú"""
    for i in range(1, len(arr)):
        key = arr[i]
        j = i - 1
        
        # Â∞áÂ§ßÊñº key ÁöÑÂÖÉÁ¥†ÂêëÂè≥ÁßªÂãï
        while j >= 0 and arr[j] > key:
            arr[j + 1] = arr[j]
            j -= 1
        
        # ÊèíÂÖ• key Âà∞Ê≠£Á¢∫‰ΩçÁΩÆ
        arr[j + 1] = key
    
    return arr

# ‰ΩøÁî®ÁØÑ‰æã
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = insertion_sort(numbers.copy())
print(f"ÊéíÂ∫èÂâç: {numbers}")
print(f"ÊéíÂ∫èÂæå: {sorted_numbers}")`,
                c: `#include <stdio.h>

void insertion_sort(int arr[], int n) {
    /* ÊèíÂÖ•ÊéíÂ∫èÊ≥ï - C ÂØ¶‰Ωú */
    int i, key, j;
    
    for (i = 1; i < n; i++) {
        key = arr[i];
        j = i - 1;
        
        /* Â∞áÂ§ßÊñº key ÁöÑÂÖÉÁ¥†ÂêëÂè≥ÁßªÂãï */
        while (j >= 0 && arr[j] > key) {
            arr[j + 1] = arr[j];
            j = j - 1;
        }
        
        /* ÊèíÂÖ• key Âà∞Ê≠£Á¢∫‰ΩçÁΩÆ */
        arr[j + 1] = key;
    }
}

int main() {
    int arr[] = {64, 34, 25, 12, 22, 11, 90};
    int n = sizeof(arr) / sizeof(arr[0]);
    
    printf("ÊéíÂ∫èÂâç: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    insertion_sort(arr, n);
    
    printf("\\nÊéíÂ∫èÂæå: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    return 0;
}`,
                java: `public class InsertionSort {
    /**
     * ÊèíÂÖ•ÊéíÂ∫èÊ≥ï - Java ÂØ¶‰Ωú
     */
    public static void insertionSort(int[] arr) {
        for (int i = 1; i < arr.length; i++) {
            int key = arr[i];
            int j = i - 1;
            
            // Â∞áÂ§ßÊñº key ÁöÑÂÖÉÁ¥†ÂêëÂè≥ÁßªÂãï
            while (j >= 0 && arr[j] > key) {
                arr[j + 1] = arr[j];
                j = j - 1;
            }
            
            // ÊèíÂÖ• key Âà∞Ê≠£Á¢∫‰ΩçÁΩÆ
            arr[j + 1] = key;
        }
    }
    
    public static void main(String[] args) {
        int[] numbers = {64, 34, 25, 12, 22, 11, 90};
        
        System.out.print("ÊéíÂ∫èÂâç: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
        
        insertionSort(numbers);
        
        System.out.print("\\nÊéíÂ∫èÂæå: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
    }
}`
            },
            bubble: {
                python: `def bubble_sort(arr):
    """Ê≥°Ê≤´ÊéíÂ∫èÊ≥ï - Python ÂØ¶‰Ωú"""
    n = len(arr)
    
    for i in range(n - 1):
        swapped = False
        
        for j in range(n - i - 1):
            # ÊØîËºÉÁõ∏ÈÑ∞ÂÖÉÁ¥†
            if arr[j] > arr[j + 1]:
                # ‰∫§ÊèõÂÖÉÁ¥†
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
                swapped = True
        
        # Â¶ÇÊûúÊ≤íÊúâ‰∫§ÊèõÁôºÁîüÔºåÈô£ÂàóÂ∑≤ÊéíÂ∫è
        if not swapped:
            break
    
    return arr

# ‰ΩøÁî®ÁØÑ‰æã
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = bubble_sort(numbers.copy())
print(f"ÊéíÂ∫èÂâç: {numbers}")
print(f"ÊéíÂ∫èÂæå: {sorted_numbers}")`,
                c: `#include <stdio.h>
#include <stdbool.h>

void bubble_sort(int arr[], int n) {
    /* Ê≥°Ê≤´ÊéíÂ∫èÊ≥ï - C ÂØ¶‰Ωú */
    int i, j, temp;
    bool swapped;
    
    for (i = 0; i < n - 1; i++) {
        swapped = false;
        
        for (j = 0; j < n - i - 1; j++) {
            /* ÊØîËºÉÁõ∏ÈÑ∞ÂÖÉÁ¥† */
            if (arr[j] > arr[j + 1]) {
                /* ‰∫§ÊèõÂÖÉÁ¥† */
                temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
                swapped = true;
            }
        }
        
        /* Â¶ÇÊûúÊ≤íÊúâ‰∫§ÊèõÁôºÁîüÔºåÈô£ÂàóÂ∑≤ÊéíÂ∫è */
        if (!swapped) {
            break;
        }
    }
}

int main() {
    int arr[] = {64, 34, 25, 12, 22, 11, 90};
    int n = sizeof(arr) / sizeof(arr[0]);
    
    printf("ÊéíÂ∫èÂâç: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    bubble_sort(arr, n);
    
    printf("\\nÊéíÂ∫èÂæå: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    return 0;
}`,
                java: `public class BubbleSort {
    /**
     * Ê≥°Ê≤´ÊéíÂ∫èÊ≥ï - Java ÂØ¶‰Ωú
     */
    public static void bubbleSort(int[] arr) {
        int n = arr.length;
        
        for (int i = 0; i < n - 1; i++) {
            boolean swapped = false;
            
            for (int j = 0; j < n - i - 1; j++) {
                // ÊØîËºÉÁõ∏ÈÑ∞ÂÖÉÁ¥†
                if (arr[j] > arr[j + 1]) {
                    // ‰∫§ÊèõÂÖÉÁ¥†
                    int temp = arr[j];
                    arr[j] = arr[j + 1];
                    arr[j + 1] = temp;
                    swapped = true;
                }
            }
            
            // Â¶ÇÊûúÊ≤íÊúâ‰∫§ÊèõÁôºÁîüÔºåÈô£ÂàóÂ∑≤ÊéíÂ∫è
            if (!swapped) {
                break;
            }
        }
    }
    
    public static void main(String[] args) {
        int[] numbers = {64, 34, 25, 12, 22, 11, 90};
        
        System.out.print("ÊéíÂ∫èÂâç: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
        
        bubbleSort(numbers);
        
        System.out.print("\\nÊéíÂ∫èÂæå: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
    }
}`
            },
            quick: {
                python: `def quick_sort(arr, low=0, high=None):
    """Âø´ÈÄüÊéíÂ∫èÊ≥ï - Python ÂØ¶‰Ωú"""
    if high is None:
        high = len(arr) - 1
    
    if low < high:
        # ÂàÜÂâ≤Èô£Âàó‰∏¶ÂèñÂæóÂü∫Ê∫ñÈªû‰ΩçÁΩÆ
        pi = partition(arr, low, high)
        
        # ÈÅûËø¥ÊéíÂ∫èÂü∫Ê∫ñÈªûÂ∑¶Âè≥ÂÖ©ÂÅ¥
        quick_sort(arr, low, pi - 1)
        quick_sort(arr, pi + 1, high)
    
    return arr

def partition(arr, low, high):
    """ÂàÜÂâ≤ÂáΩÊï∏"""
    pivot = arr[high]  # ÈÅ∏ÊìáÊúÄÂæå‰∏ÄÂÄãÂÖÉÁ¥†‰ΩúÁÇ∫Âü∫Ê∫ñÈªû
    i = low - 1        # ËºÉÂ∞èÂÖÉÁ¥†ÁöÑÁ¥¢Âºï
    
    for j in range(low, high):
        if arr[j] <= pivot:
            i += 1
            arr[i], arr[j] = arr[j], arr[i]
    
    arr[i + 1], arr[high] = arr[high], arr[i + 1]
    return i + 1

# ‰ΩøÁî®ÁØÑ‰æã
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = quick_sort(numbers.copy())
print(f"ÊéíÂ∫èÂâç: {numbers}")
print(f"ÊéíÂ∫èÂæå: {sorted_numbers}")`,
                c: `#include <stdio.h>

int partition(int arr[], int low, int high) {
    /* ÂàÜÂâ≤ÂáΩÊï∏ */
    int pivot = arr[high];  // ÈÅ∏ÊìáÊúÄÂæå‰∏ÄÂÄãÂÖÉÁ¥†‰ΩúÁÇ∫Âü∫Ê∫ñÈªû
    int i = (low - 1);      // ËºÉÂ∞èÂÖÉÁ¥†ÁöÑÁ¥¢Âºï
    int temp;
    
    for (int j = low; j <= high - 1; j++) {
        if (arr[j] <= pivot) {
            i++;
            temp = arr[i];
            arr[i] = arr[j];
            arr[j] = temp;
        }
    }
    
    temp = arr[i + 1];
    arr[i + 1] = arr[high];
    arr[high] = temp;
    
    return (i + 1);
}

void quick_sort(int arr[], int low, int high) {
    /* Âø´ÈÄüÊéíÂ∫èÊ≥ï - C ÂØ¶‰Ωú */
    if (low < high) {
        // ÂàÜÂâ≤Èô£Âàó‰∏¶ÂèñÂæóÂü∫Ê∫ñÈªû‰ΩçÁΩÆ
        int pi = partition(arr, low, high);
        
        // ÈÅûËø¥ÊéíÂ∫èÂü∫Ê∫ñÈªûÂ∑¶Âè≥ÂÖ©ÂÅ¥
        quick_sort(arr, low, pi - 1);
        quick_sort(arr, pi + 1, high);
    }
}

int main() {
    int arr[] = {64, 34, 25, 12, 22, 11, 90};
    int n = sizeof(arr) / sizeof(arr[0]);
    
    printf("ÊéíÂ∫èÂâç: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    quick_sort(arr, 0, n - 1);
    
    printf("\\nÊéíÂ∫èÂæå: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    return 0;
}`,
                java: `public class QuickSort {
    /**
     * Âø´ÈÄüÊéíÂ∫èÊ≥ï - Java ÂØ¶‰Ωú
     */
    public static void quickSort(int[] arr, int low, int high) {
        if (low < high) {
            // ÂàÜÂâ≤Èô£Âàó‰∏¶ÂèñÂæóÂü∫Ê∫ñÈªû‰ΩçÁΩÆ
            int pi = partition(arr, low, high);
            
            // ÈÅûËø¥ÊéíÂ∫èÂü∫Ê∫ñÈªûÂ∑¶Âè≥ÂÖ©ÂÅ¥
            quickSort(arr, low, pi - 1);
            quickSort(arr, pi + 1, high);
        }
    }
    
    /**
     * ÂàÜÂâ≤ÂáΩÊï∏
     */
    static int partition(int[] arr, int low, int high) {
        int pivot = arr[high];  // ÈÅ∏ÊìáÊúÄÂæå‰∏ÄÂÄãÂÖÉÁ¥†‰ΩúÁÇ∫Âü∫Ê∫ñÈªû
        int i = (low - 1);      // ËºÉÂ∞èÂÖÉÁ¥†ÁöÑÁ¥¢Âºï
        
        for (int j = low; j < high; j++) {
            if (arr[j] <= pivot) {
                i++;
                
                // ‰∫§ÊèõÂÖÉÁ¥†
                int temp = arr[i];
                arr[i] = arr[j];
                arr[j] = temp;
            }
        }
        
        // ‰∫§ÊèõÂü∫Ê∫ñÈªûÂà∞Ê≠£Á¢∫‰ΩçÁΩÆ
        int temp = arr[i + 1];
        arr[i + 1] = arr[high];
        arr[high] = temp;
        
        return i + 1;
    }
    
    public static void main(String[] args) {
        int[] numbers = {64, 34, 25, 12, 22, 11, 90};
        
        System.out.print("ÊéíÂ∫èÂâç: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
        
        quickSort(numbers, 0, numbers.length - 1);
        
        System.out.print("\\nÊéíÂ∫èÂæå: ");
        for (int num : numbers) {
            System.out.print(num + " ");
        }
    }
}`
            },
            binary: {
                python: `def binary_search(arr, target):
    """‰∫åÂÖÉÊêúÂ∞ãÊ≥ï - Python ÂØ¶‰Ωú"""
    left = 0
    right = len(arr) - 1
    
    while left <= right:
        mid = (left + right) // 2
        
        if arr[mid] == target:
            return mid  # ÊâæÂà∞ÁõÆÊ®ôÔºåÂõûÂÇ≥Á¥¢Âºï
        elif arr[mid] < target:
            left = mid + 1  # ÊêúÂ∞ãÂè≥ÂçäÈÉ®
        else:
            right = mid - 1  # ÊêúÂ∞ãÂ∑¶ÂçäÈÉ®
    
    return -1  # Êú™ÊâæÂà∞ÁõÆÊ®ô

# ‰ΩøÁî®ÁØÑ‰æã
sorted_numbers = [11, 12, 22, 25, 34, 64, 90]
target = 25

result = binary_search(sorted_numbers, target)
if result != -1:
    print(f"ÊâæÂà∞ {target} Âú®Á¥¢Âºï {result}")
else:
    print(f"Êú™ÊâæÂà∞ {target}")

# ÊêúÂ∞ãÊâÄÊúâÂÖÉÁ¥†
for num in [22, 50, 90]:
    idx = binary_search(sorted_numbers, num)
    print(f"ÊêúÂ∞ã {num}: {'ÊâæÂà∞Âú®Á¥¢Âºï ' + str(idx) if idx != -1 else 'Êú™ÊâæÂà∞'}")`,
                c: `#include <stdio.h>

int binary_search(int arr[], int n, int target) {
    /* ‰∫åÂÖÉÊêúÂ∞ãÊ≥ï - C ÂØ¶‰Ωú */
    int left = 0;
    int right = n - 1;
    
    while (left <= right) {
        int mid = left + (right - left) / 2;
        
        if (arr[mid] == target) {
            return mid;  // ÊâæÂà∞ÁõÆÊ®ôÔºåÂõûÂÇ≥Á¥¢Âºï
        }
        else if (arr[mid] < target) {
            left = mid + 1;  // ÊêúÂ∞ãÂè≥ÂçäÈÉ®
        }
        else {
            right = mid - 1;  // ÊêúÂ∞ãÂ∑¶ÂçäÈÉ®
        }
    }
    
    return -1;  // Êú™ÊâæÂà∞ÁõÆÊ®ô
}

int main() {
    int arr[] = {11, 12, 22, 25, 34, 64, 90};
    int n = sizeof(arr) / sizeof(arr[0]);
    int target = 25;
    
    printf("Èô£Âàó: ");
    for (int i = 0; i < n; i++) {
        printf("%d ", arr[i]);
    }
    
    int result = binary_search(arr, n, target);
    
    if (result != -1) {
        printf("\\nÊâæÂà∞ %d Âú®Á¥¢Âºï %d\\n", target, result);
    } else {
        printf("\\nÊú™ÊâæÂà∞ %d\\n", target);
    }
    
    return 0;
}`,
                java: `public class BinarySearch {
    /**
     * ‰∫åÂÖÉÊêúÂ∞ãÊ≥ï - Java ÂØ¶‰Ωú
     */
    public static int binarySearch(int[] arr, int target) {
        int left = 0;
        int right = arr.length - 1;
        
        while (left <= right) {
            int mid = left + (right - left) / 2;
            
            if (arr[mid] == target) {
                return mid;  // ÊâæÂà∞ÁõÆÊ®ôÔºåÂõûÂÇ≥Á¥¢Âºï
            }
            else if (arr[mid] < target) {
                left = mid + 1;  // ÊêúÂ∞ãÂè≥ÂçäÈÉ®
            }
            else {
                right = mid - 1;  // ÊêúÂ∞ãÂ∑¶ÂçäÈÉ®
            }
        }
        
        return -1;  // Êú™ÊâæÂà∞ÁõÆÊ®ô
    }
    
    public static void main(String[] args) {
        int[] sortedNumbers = {11, 12, 22, 25, 34, 64, 90};
        int target = 25;
        
        System.out.print("Èô£Âàó: ");
        for (int num : sortedNumbers) {
            System.out.print(num + " ");
        }
        
        int result = binarySearch(sortedNumbers, target);
        
        if (result != -1) {
            System.out.println("\\nÊâæÂà∞ " + target + " Âú®Á¥¢Âºï " + result);
        } else {
            System.out.println("\\nÊú™ÊâæÂà∞ " + target);
        }
        
        // ÊêúÂ∞ãÂ§öÂÄãÁõÆÊ®ô
        int[] targets = {22, 50, 90};
        for (int t : targets) {
            int idx = binarySearch(sortedNumbers, t);
            System.out.println("ÊêúÂ∞ã " + t + ": " + 
                (idx != -1 ? "ÊâæÂà∞Âú®Á¥¢Âºï " + idx : "Êú™ÊâæÂà∞"));
        }
    }
}`
            },
            fibonacci: {
                python: `def fibonacci_recursive(n):
    """ÈÅûËø¥ÁâàÊú¨ Fibonacci - Python ÂØ¶‰Ωú"""
    if n <= 1:
        return n
    return fibonacci_recursive(n - 1) + fibonacci_recursive(n - 2)

def fibonacci_dp(n):
    """ÂãïÊÖãË¶èÂäÉÁâàÊú¨ Fibonacci - Python ÂØ¶‰Ωú"""
    if n <= 1:
        return n
    
    # Âª∫Á´ã DP Ë°®Ê†º
    dp = [0] * (n + 1)
    dp[1] = 1
    
    for i in range(2, n + 1):
        dp[i] = dp[i - 1] + dp[i - 2]
    
    return dp[n]

def fibonacci_optimized(n):
    """Á©∫ÈñìÂÑ™ÂåñÁâàÊú¨ - Âè™‰ΩøÁî®ÂÖ©ÂÄãËÆäÊï∏"""
    if n <= 1:
        return n
    
    a, b = 0, 1
    for i in range(2, n + 1):
        a, b = b, a + b
    
    return b

# ‰ΩøÁî®ÁØÑ‰æã
n = 10
print(f"Fibonacci({n}):")
print(f"ÈÅûËø¥ÁâàÊú¨: {fibonacci_recursive(n)}")
print(f"ÂãïÊÖãË¶èÂäÉ: {fibonacci_dp(n)}")
print(f"ÂÑ™ÂåñÁâàÊú¨: {fibonacci_optimized(n)}")

# ÊØîËºÉÊïàËÉΩ
import time
n = 35
start = time.time()
result1 = fibonacci_recursive(n)
time1 = time.time() - start

start = time.time()
result2 = fibonacci_dp(n)
time2 = time.time() - start

print(f"\\nÊïàËÉΩÊØîËºÉ (n={n}):")
print(f"ÈÅûËø¥: {time1:.4f}Áßí")
print(f"ÂãïÊÖãË¶èÂäÉ: {time2:.4f}Áßí")`,
                c: `#include <stdio.h>
#include <time.h>

long long fibonacci_recursive(int n) {
    /* ÈÅûËø¥ÁâàÊú¨ Fibonacci - C ÂØ¶‰Ωú */
    if (n <= 1) {
        return n;
    }
    return fibonacci_recursive(n - 1) + fibonacci_recursive(n - 2);
}

long long fibonacci_dp(int n) {
    /* ÂãïÊÖãË¶èÂäÉÁâàÊú¨ Fibonacci - C ÂØ¶‰Ωú */
    if (n <= 1) {
        return n;
    }
    
    long long dp[n + 1];
    dp[0] = 0;
    dp[1] = 1;
    
    for (int i = 2; i <= n; i++) {
        dp[i] = dp[i - 1] + dp[i - 2];
    }
    
    return dp[n];
}

long long fibonacci_optimized(int n) {
    /* Á©∫ÈñìÂÑ™ÂåñÁâàÊú¨ - Âè™‰ΩøÁî®ÂÖ©ÂÄãËÆäÊï∏ */
    if (n <= 1) {
        return n;
    }
    
    long long a = 0, b = 1, temp;
    for (int i = 2; i <= n; i++) {
        temp = a + b;
        a = b;
        b = temp;
    }
    
    return b;
}

int main() {
    int n = 10;
    
    printf("Fibonacci(%d):\\n", n);
    printf("ÈÅûËø¥ÁâàÊú¨: %lld\\n", fibonacci_recursive(n));
    printf("ÂãïÊÖãË¶èÂäÉ: %lld\\n", fibonacci_dp(n));
    printf("ÂÑ™ÂåñÁâàÊú¨: %lld\\n", fibonacci_optimized(n));
    
    // ÊïàËÉΩÊØîËºÉ
    n = 40;
    clock_t start, end;
    
    start = clock();
    long long result1 = fibonacci_recursive(n);
    end = clock();
    double time1 = ((double)(end - start)) / CLOCKS_PER_SEC;
    
    start = clock();
    long long result2 = fibonacci_dp(n);
    end = clock();
    double time2 = ((double)(end - start)) / CLOCKS_PER_SEC;
    
    printf("\\nÊïàËÉΩÊØîËºÉ (n=%d):\\n", n);
    printf("ÈÅûËø¥: %.4fÁßí\\n", time1);
    printf("ÂãïÊÖãË¶èÂäÉ: %.4fÁßí\\n", time2);
    
    return 0;
}`,
                java: `public class Fibonacci {
    /**
     * ÈÅûËø¥ÁâàÊú¨ Fibonacci - Java ÂØ¶‰Ωú
     */
    public static long fibonacciRecursive(int n) {
        if (n <= 1) {
            return n;
        }
        return fibonacciRecursive(n - 1) + fibonacciRecursive(n - 2);
    }
    
    /**
     * ÂãïÊÖãË¶èÂäÉÁâàÊú¨ Fibonacci - Java ÂØ¶‰Ωú
     */
    public static long fibonacciDP(int n) {
        if (n <= 1) {
            return n;
        }
        
        long[] dp = new long[n + 1];
        dp[0] = 0;
        dp[1] = 1;
        
        for (int i = 2; i <= n; i++) {
            dp[i] = dp[i - 1] + dp[i - 2];
        }
        
        return dp[n];
    }
    
    /**
     * Á©∫ÈñìÂÑ™ÂåñÁâàÊú¨ - Âè™‰ΩøÁî®ÂÖ©ÂÄãËÆäÊï∏
     */
    public static long fibonacciOptimized(int n) {
        if (n <= 1) {
            return n;
        }
        
        long a = 0, b = 1;
        for (int i = 2; i <= n; i++) {
            long temp = a + b;
            a = b;
            b = temp;
        }
        
        return b;
    }
    
    public static void main(String[] args) {
        int n = 10;
        
        System.out.println("Fibonacci(" + n + "):");
        System.out.println("ÈÅûËø¥ÁâàÊú¨: " + fibonacciRecursive(n));
        System.out.println("ÂãïÊÖãË¶èÂäÉ: " + fibonacciDP(n));
        System.out.println("ÂÑ™ÂåñÁâàÊú¨: " + fibonacciOptimized(n));
        
        // ÊïàËÉΩÊØîËºÉ
        n = 40;
        long start, end;
        
        start = System.nanoTime();
        long result1 = fibonacciRecursive(n);
        end = System.nanoTime();
        double time1 = (end - start) / 1_000_000_000.0;
        
        start = System.nanoTime();
        long result2 = fibonacciDP(n);
        end = System.nanoTime();
        double time2 = (end - start) / 1_000_000_000.0;
        
        System.out.println("\\nÊïàËÉΩÊØîËºÉ (n=" + n + "):");
        System.out.printf("ÈÅûËø¥: %.4fÁßí%n", time1);
        System.out.printf("ÂãïÊÖãË¶èÂäÉ: %.4fÁßí%n", time2);
    }
}`
            }
        };

        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            generateArray();
            updateComplexityInfo();
            updateCodeDisplay();
        });

        function selectAlgorithm(algo) {
            // ÂÅúÊ≠¢Áï∂ÂâçÈÅãË°åÁöÑÊéíÂ∫è
            stopSort();
            
            currentAlgorithm = algo;
            
            // Êõ¥Êñ∞ÊåâÈàïÁãÄÊÖã
            document.querySelectorAll('.algo-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // È°ØÁ§∫/Èö±ËóèÁõ∏ÊáâÁöÑÂÆπÂô®
            document.getElementById('searchContainer').style.display = algo === 'binary' ? 'flex' : 'none';
            document.getElementById('fibonacciContainer').style.display = algo === 'fibonacci' ? 'flex' : 'none';
            document.getElementById('arrayContainer').style.display = algo === 'fibonacci' ? 'none' : 'flex';
            
            // Êõ¥Êñ∞ÊéßÂà∂ÊåâÈàï
            const startBtn = document.getElementById('startBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            
            if (algo === 'binary') {
                startBtn.textContent = 'Ê∫ñÂÇôÊêúÂ∞ã';
                startBtn.onclick = () => generateSortedArray();
                pauseBtn.style.display = 'none';
            } else if (algo === 'fibonacci') {
                startBtn.style.display = 'none';
                pauseBtn.style.display = 'none';
            } else {
                startBtn.textContent = 'ÈñãÂßãÊéíÂ∫è';
                startBtn.onclick = startSort;
                startBtn.style.display = 'inline-block';
                pauseBtn.style.display = 'none';
            }
            
            resetArray();
            updateComplexityInfo();
            updateCodeDisplay();
        }

        function showLanguage(language) {
            currentLanguage = language;
            
            // Êõ¥Êñ∞ÊåâÈàïÁãÄÊÖã
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateCodeDisplay();
        }

        function updateCodeDisplay() {
            const code = codeExamples[currentAlgorithm]?.[currentLanguage] || '// Á®ãÂºèÁ¢ºËºâÂÖ•‰∏≠...';
            document.getElementById('codeDisplay').textContent = code;
        }

        function generateArray() {
            const size = parseInt(document.getElementById('arraySize').value);
            document.getElementById('sizeValue').textContent = size;
            
            array = [];
            for (let i = 0; i < size; i++) {
                array.push(Math.floor(Math.random() * 99) + 1);
            }
            originalArray = [...array];
            renderArray();
            updateStepInfo('Â∑≤Áî¢ÁîüÊñ∞ÁöÑÈö®Ê©üÈô£Âàó');
        }

        function generateSortedArray() {
            generateArray();
            array.sort((a, b) => a - b);
            originalArray = [...array];
            renderArray();
            updateStepInfo('Â∑≤Áî¢ÁîüÊéíÂ∫èÂ•ΩÁöÑÈô£ÂàóÔºåÂèØ‰ª•ÈñãÂßã‰∫åÂÖÉÊêúÂ∞ã');
        }

        function resetArray() {
            // ÂÅúÊ≠¢Áï∂ÂâçÈÅãË°åÁöÑÊéíÂ∫è
            stopSort();
            
            if (originalArray.length > 0) {
                array = [...originalArray];
                renderArray();
                updateStepInfo('Èô£ÂàóÂ∑≤ÈáçÁΩÆ');
            }
        }

        function renderArray() {
            const container = document.getElementById('arrayContainer');
            container.innerHTML = '';
            
            array.forEach((value, index) => {
                const element = document.createElement('div');
                element.className = 'array-element';
                element.textContent = value;
                element.id = `element-${index}`;
                container.appendChild(element);
            });
        }

        function updateStepInfo(message) {
            document.getElementById('stepInfo').textContent = message;
        }

        function updateComplexityInfo() {
            const complexities = {
                selection: {
                    name: 'ÈÅ∏ÊìáÊéíÂ∫èÊ≥ï',
                    time: 'O(n¬≤)',
                    space: 'O(1)',
                    description: 'ÊØèÊ¨°ÊâæÂà∞ÊúÄÂ∞èÂÄº‰∏¶ÊîæÂà∞Ê≠£Á¢∫‰ΩçÁΩÆ'
                },
                insertion: {
                    name: 'ÊèíÂÖ•ÊéíÂ∫èÊ≥ï',
                    time: 'O(n¬≤)',
                    space: 'O(1)',
                    description: 'Â∞áÊØèÂÄãÂÖÉÁ¥†ÊèíÂÖ•Âà∞Â∑≤ÊéíÂ∫èÈÉ®ÂàÜÁöÑÊ≠£Á¢∫‰ΩçÁΩÆ'
                },
                bubble: {
                    name: 'Ê≥°Ê≤´ÊéíÂ∫èÊ≥ï',
                    time: 'O(n¬≤)',
                    space: 'O(1)',
                    description: 'ÈáçË§áÊØîËºÉÁõ∏ÈÑ∞ÂÖÉÁ¥†‰∏¶‰∫§Êèõ'
                },
                quick: {
                    name: 'Âø´ÈÄüÊéíÂ∫èÊ≥ï',
                    time: 'O(n log n)',
                    space: 'O(log n)',
                    description: 'ÈÅ∏ÊìáÂü∫Ê∫ñÈªû‰∏¶ÂàÜÂâ≤Èô£ÂàóÈÅûËø¥ÊéíÂ∫è'
                },
                binary: {
                    name: '‰∫åÂÖÉÊêúÂ∞ãÊ≥ï',
                    time: 'O(log n)',
                    space: 'O(1)',
                    description: 'Âú®Â∑≤ÊéíÂ∫èÈô£Âàó‰∏≠Âø´ÈÄüÊâæÂà∞ÁõÆÊ®ôÂÄº'
                },
                fibonacci: {
                    name: 'ÂãïÊÖãË¶èÂäÉ (Fibonacci)',
                    time: 'O(n) vs O(2‚Åø)',
                    space: 'O(n) vs O(n)',
                    description: '‰ΩøÁî®Ë®òÊÜ∂ÂåñÈÅøÂÖçÈáçË§áË®àÁÆó'
                }
            };

            const info = complexities[currentAlgorithm];
            document.getElementById('complexityInfo').innerHTML = `
                <div class="complexity-card">
                    <h3>${info.name}</h3>
                    <p><strong>ÊôÇÈñìË§áÈõúÂ∫¶:</strong> ${info.time}</p>
                    <p><strong>Á©∫ÈñìË§áÈõúÂ∫¶:</strong> ${info.space}</p>
                    <p>${info.description}</p>
                </div>
            `;
        }

        async function startSort() {
            if (isRunning && !isPaused) return;
            
            if (isPaused) {
                // ÁπºÁ∫åÊéíÂ∫è
                isPaused = false;
                document.getElementById('startBtn').textContent = 'ÈñãÂßãÊéíÂ∫è';
                document.getElementById('pauseBtn').textContent = 'Êö´ÂÅú';
                updateStepInfo('ÁπºÁ∫åÊéíÂ∫è...');
                return;
            }
            
            isRunning = true;
            isPaused = false;
            shouldStop = false;
            animationSpeed = 1100 - parseInt(document.getElementById('speed').value);
            
            // Êõ¥Êñ∞ÊåâÈàïÁãÄÊÖã
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            
            try {
                switch (currentAlgorithm) {
                    case 'selection':
                        await selectionSort();
                        break;
                    case 'insertion':
                        await insertionSort();
                        break;
                    case 'bubble':
                        await bubbleSort();
                        break;
                    case 'quick':
                        await quickSort(0, array.length - 1);
                        break;
                }
                
                if (!shouldStop) {
                    // Ê®ôË®òÊâÄÊúâÂÖÉÁ¥†ÁÇ∫Â∑≤ÊéíÂ∫è
                    for (let i = 0; i < array.length; i++) {
                        const element = document.getElementById(`element-${i}`);
                        if (element) element.classList.add('sorted');
                    }
                    updateStepInfo('ÊéíÂ∫èÂÆåÊàêÔºÅ');
                }
            } catch (error) {
                if (error.message !== 'STOPPED') {
                    console.error('ÊéíÂ∫èÈÅéÁ®ã‰∏≠ÁôºÁîüÈåØË™§:', error);
                }
            }
            
            // ÈáçÁΩÆÊåâÈàïÁãÄÊÖã
            isRunning = false;
            isPaused = false;
            document.getElementById('startBtn').style.display = 'inline-block';
            document.getElementById('startBtn').textContent = 'ÈñãÂßãÊéíÂ∫è';
            document.getElementById('pauseBtn').style.display = 'none';
        }

        function pauseSort() {
            if (isRunning && !isPaused) {
                isPaused = true;
                document.getElementById('startBtn').style.display = 'inline-block';
                document.getElementById('startBtn').textContent = 'ÁπºÁ∫å';
                document.getElementById('pauseBtn').textContent = 'Â∑≤Êö´ÂÅú';
                updateStepInfo('ÊéíÂ∫èÂ∑≤Êö´ÂÅúÔºåÈªûÊìä„ÄåÁπºÁ∫å„ÄçÊåâÈàïÊÅ¢Âæ©');
            }
        }

        function stopSort() {
            if (isRunning) {
                shouldStop = true;
                isPaused = false;
                isRunning = false;
                
                // ÈáçÁΩÆÊåâÈàïÁãÄÊÖã
                document.getElementById('startBtn').style.display = 'inline-block';
                document.getElementById('startBtn').textContent = 'ÈñãÂßãÊéíÂ∫è';
                document.getElementById('pauseBtn').style.display = 'none';
                
                // Ê∏ÖÈô§ÊâÄÊúâÂãïÁï´ÁãÄÊÖã
                document.querySelectorAll('.array-element').forEach(element => {
                    element.classList.remove('comparing', 'swapping', 'sorted', 'pivot');
                });
                
                updateStepInfo('ÊéíÂ∫èÂ∑≤ÂÅúÊ≠¢');
            }
        }

        async function selectionSort() {
            for (let i = 0; i < array.length - 1; i++) {
                if (shouldStop) throw new Error('STOPPED');
                
                let minIndex = i;
                const element_i = document.getElementById(`element-${i}`);
                if (element_i) element_i.classList.add('comparing');
                
                updateStepInfo(`Á¨¨ ${i + 1} Ëº™ÔºöÂ∞ãÊâæ‰ΩçÁΩÆ ${i} Âà∞ ${array.length - 1} ‰∏≠ÁöÑÊúÄÂ∞èÂÄº`);
                
                for (let j = i + 1; j < array.length; j++) {
                    if (shouldStop) throw new Error('STOPPED');
                    
                    const element_j = document.getElementById(`element-${j}`);
                    if (element_j) element_j.classList.add('comparing');
                    await sleep(animationSpeed);
                    
                    if (array[j] < array[minIndex]) {
                        if (minIndex !== i) {
                            const element_min = document.getElementById(`element-${minIndex}`);
                            if (element_min) element_min.classList.remove('comparing');
                        }
                        minIndex = j;
                        updateStepInfo(`ÊâæÂà∞Êõ¥Â∞èÁöÑÂÄº ${array[j]} Âú®‰ΩçÁΩÆ ${j}`);
                    } else {
                        if (element_j) element_j.classList.remove('comparing');
                    }
                }
                
                if (minIndex !== i) {
                    const element_i_swap = document.getElementById(`element-${i}`);
                    const element_min_swap = document.getElementById(`element-${minIndex}`);
                    if (element_i_swap) element_i_swap.classList.add('swapping');
                    if (element_min_swap) element_min_swap.classList.add('swapping');
                    
                    updateStepInfo(`‰∫§Êèõ‰ΩçÁΩÆ ${i} Âíå ${minIndex} ÁöÑÂÖÉÁ¥†`);
                    
                    // Êí≠Êîæ‰∫§ÊèõÂãïÁï´
                    await animateSwap(i, minIndex);
                    
                    [array[i], array[minIndex]] = [array[minIndex], array[i]];
                    renderArray();
                    
                    updateStepInfo(`‰∫§ÊèõÂÆåÊàêÔºö${array[i]} Âíå ${array[minIndex]}`);
                }
                
                const final_element = document.getElementById(`element-${i}`);
                if (final_element) {
                    final_element.classList.remove('comparing', 'swapping');
                    final_element.classList.add('sorted');
                }
            }
        }

        async function insertionSort() {
            const first_element = document.getElementById(`element-0`);
            if (first_element) first_element.classList.add('sorted');
            
            for (let i = 1; i < array.length; i++) {
                if (shouldStop) throw new Error('STOPPED');
                
                let key = array[i];
                let j = i - 1;
                
                const element_i = document.getElementById(`element-${i}`);
                if (element_i) element_i.classList.add('comparing');
                updateStepInfo(`ÊèíÂÖ• ${key} Âà∞Â∑≤ÊéíÂ∫èÈÉ®ÂàÜ`);
                
                while (j >= 0 && array[j] > key) {
                    if (shouldStop) throw new Error('STOPPED');
                    
                    const element_j = document.getElementById(`element-${j}`);
                    const element_j1 = document.getElementById(`element-${j + 1}`);
                    if (element_j) element_j.classList.add('swapping');
                    if (element_j1) element_j1.classList.add('swapping');
                    
                    updateStepInfo(`ÁßªÂãï ${array[j]} ÂêëÂè≥‰∏Ä‰Ωç`);
                    
                    // Êí≠ÊîæÁßªÂãïÂãïÁï´
                    await animateInsert(j, j + 1);
                    
                    array[j + 1] = array[j];
                    renderArray();
                    
                    const element_j_after = document.getElementById(`element-${j}`);
                    const element_j1_after = document.getElementById(`element-${j + 1}`);
                    if (element_j_after) element_j_after.classList.remove('swapping');
                    if (element_j1_after) element_j1_after.classList.remove('swapping');
                    j--;
                }
                
                array[j + 1] = key;
                renderArray();
                
                for (let k = 0; k <= i; k++) {
                    const element_k = document.getElementById(`element-${k}`);
                    if (element_k) element_k.classList.add('sorted');
                }
                
                updateStepInfo(`${key} Â∑≤ÊèíÂÖ•Âà∞Ê≠£Á¢∫‰ΩçÁΩÆ`);
                await sleep(animationSpeed);
            }
        }

        async function bubbleSort() {
            for (let i = 0; i < array.length - 1; i++) {
                if (shouldStop) throw new Error('STOPPED');
                
                let swapped = false;
                updateStepInfo(`Á¨¨ ${i + 1} Ëº™Ê≥°Ê≤´ÊéíÂ∫è`);
                
                for (let j = 0; j < array.length - i - 1; j++) {
                    if (shouldStop) throw new Error('STOPPED');
                    
                    const element_j = document.getElementById(`element-${j}`);
                    const element_j1 = document.getElementById(`element-${j + 1}`);
                    if (element_j) element_j.classList.add('comparing');
                    if (element_j1) element_j1.classList.add('comparing');
                    
                    await sleep(animationSpeed);
                    
                    if (array[j] > array[j + 1]) {
                        if (element_j) element_j.classList.add('swapping');
                        if (element_j1) element_j1.classList.add('swapping');
                        
                        updateStepInfo(`‰∫§Êèõ ${array[j]} Âíå ${array[j + 1]}`);
                        
                        // Êí≠Êîæ‰∫§ÊèõÂãïÁï´
                        await animateSwap(j, j + 1);
                        
                        [array[j], array[j + 1]] = [array[j + 1], array[j]];
                        swapped = true;
                        
                        renderArray();
                        updateStepInfo(`‰∫§ÊèõÂÆåÊàêÔºö${array[j]} Âíå ${array[j + 1]}`);
                    }
                    
                    const element_j_after = document.getElementById(`element-${j}`);
                    const element_j1_after = document.getElementById(`element-${j + 1}`);
                    if (element_j_after) element_j_after.classList.remove('comparing', 'swapping');
                    if (element_j1_after) element_j1_after.classList.remove('comparing', 'swapping');
                }
                
                const sorted_element = document.getElementById(`element-${array.length - 1 - i}`);
                if (sorted_element) sorted_element.classList.add('sorted');
                
                if (!swapped) {
                    updateStepInfo('Ê≤íÊúâÁôºÁîü‰∫§ÊèõÔºåÊéíÂ∫èÊèêÂâçÂÆåÊàêÔºÅ');
                    break;
                }
            }
        }

        async function quickSort(low, high) {
            if (shouldStop) throw new Error('STOPPED');
            if (low < high) {
                let pi = await partition(low, high);
                await quickSort(low, pi - 1);
                await quickSort(pi + 1, high);
            }
        }

        async function partition(low, high) {
            if (shouldStop) throw new Error('STOPPED');
            
            let pivot = array[high];
            const pivot_element = document.getElementById(`element-${high}`);
            if (pivot_element) pivot_element.classList.add('pivot');
            updateStepInfo(`ÈÅ∏Êìá ${pivot} ‰ΩúÁÇ∫Âü∫Ê∫ñÈªû`);
            
            let i = low - 1;
            
            for (let j = low; j < high; j++) {
                if (shouldStop) throw new Error('STOPPED');
                
                const element_j = document.getElementById(`element-${j}`);
                if (element_j) element_j.classList.add('comparing');
                await sleep(animationSpeed);
                
                if (array[j] < pivot) {
                    i++;
                    if (i !== j) {
                        const element_i = document.getElementById(`element-${i}`);
                        const element_j_swap = document.getElementById(`element-${j}`);
                        if (element_i) element_i.classList.add('swapping');
                        if (element_j_swap) element_j_swap.classList.add('swapping');
                        
                        updateStepInfo(`‰∫§Êèõ ${array[i]} Âíå ${array[j]}`);
                        
                        // Êí≠Êîæ‰∫§ÊèõÂãïÁï´
                        await animateSwap(i, j);
                        
                        [array[i], array[j]] = [array[j], array[i]];
                        renderArray();
                        
                        const element_i_after = document.getElementById(`element-${i}`);
                        const element_j_after = document.getElementById(`element-${j}`);
                        if (element_i_after) element_i_after.classList.remove('swapping');
                        if (element_j_after) element_j_after.classList.remove('swapping');
                    }
                    updateStepInfo(`${array[i]} < ${pivot}ÔºåÁßªÂà∞Â∑¶ÂÅ¥`);
                }
                
                const element_j_final = document.getElementById(`element-${j}`);
                if (element_j_final) element_j_final.classList.remove('comparing');
            }
            
            const element_i1 = document.getElementById(`element-${i + 1}`);
            const element_high = document.getElementById(`element-${high}`);
            if (element_i1) element_i1.classList.add('swapping');
            if (element_high) element_high.classList.add('swapping');
            
            updateStepInfo(`Â∞áÂü∫Ê∫ñÈªû ${pivot} ÁßªÂà∞Ê≠£Á¢∫‰ΩçÁΩÆ`);
            
            // Êí≠ÊîæÂü∫Ê∫ñÈªû‰∫§ÊèõÂãïÁï´
            await animateSwap(i + 1, high);
            
            [array[i + 1], array[high]] = [array[high], array[i + 1]];
            renderArray();
            
            const element_i1_final = document.getElementById(`element-${i + 1}`);
            const element_high_final = document.getElementById(`element-${high}`);
            if (element_i1_final) {
                element_i1_final.classList.remove('swapping', 'pivot');
                element_i1_final.classList.add('sorted');
            }
            if (element_high_final) element_high_final.classList.remove('swapping');
            
            updateStepInfo(`Âü∫Ê∫ñÈªû ${pivot} Â∑≤ÊîæÂà∞Ê≠£Á¢∫‰ΩçÁΩÆ`);
            return i + 1;
        }

        async function startBinarySearch() {
            const target = parseInt(document.getElementById('searchTarget').value);
            if (isNaN(target)) {
                updateStepInfo('Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊï∏Â≠ó');
                return;
            }
            
            updateStepInfo(`ÈñãÂßãÊêúÂ∞ã ${target}`);
            const result = await binarySearch(target);
            
            if (result !== -1) {
                document.getElementById('searchResult').textContent = `ÊâæÂà∞‰∫ÜÔºÅ${target} Âú®‰ΩçÁΩÆ ${result}`;
                document.getElementById(`element-${result}`).classList.add('sorted');
            } else {
                document.getElementById('searchResult').textContent = `Ê≤íÊúâÊâæÂà∞ ${target}`;
            }
        }

        async function binarySearch(target) {
            let left = 0;
            let right = array.length - 1;
            
            while (left <= right) {
                if (shouldStop) throw new Error('STOPPED');
                
                let mid = Math.floor((left + right) / 2);
                
                // Ê∏ÖÈô§‰πãÂâçÁöÑÊ®ôË®ò
                document.querySelectorAll('.array-element').forEach(el => {
                    el.classList.remove('comparing', 'swapping');
                });
                
                // Ê®ôË®òÊêúÂ∞ãÁØÑÂúç
                for (let i = left; i <= right; i++) {
                    const element = document.getElementById(`element-${i}`);
                    if (element) element.classList.add('comparing');
                }
                const mid_element = document.getElementById(`element-${mid}`);
                if (mid_element) mid_element.classList.add('swapping');
                
                updateStepInfo(`ÊêúÂ∞ãÁØÑÂúç [${left}, ${right}]ÔºåÊ™¢Êü•‰∏≠Èñì‰ΩçÁΩÆ ${mid}Ôºö${array[mid]}`);
                await sleep(animationSpeed * 2);
                
                if (array[mid] === target) {
                    updateStepInfo(`ÊâæÂà∞ÁõÆÊ®ôÂÄº ${target}ÔºÅ`);
                    return mid;
                } else if (array[mid] < target) {
                    updateStepInfo(`${array[mid]} < ${target}ÔºåÊêúÂ∞ãÂè≥ÂçäÈÉ®`);
                    left = mid + 1;
                } else {
                    updateStepInfo(`${array[mid]} > ${target}ÔºåÊêúÂ∞ãÂ∑¶ÂçäÈÉ®`);
                    right = mid - 1;
                }
            }
            
            updateStepInfo(`ÊêúÂ∞ãÂÆåÁï¢ÔºåÊú™ÊâæÂà∞ ${target}`);
            return -1;
        }

        function calculateFibonacci() {
            const n = parseInt(document.getElementById('fibInput').value);
            if (isNaN(n) || n < 1) {
                updateStepInfo('Ë´ãËº∏ÂÖ•ÊúâÊïàÁöÑÊ≠£Êï¥Êï∏');
                return;
            }
            
            // ÈÅûËø¥ÊñπÊ≥ï
            let recursiveCalls = 0;
            const startRecursive = performance.now();
            
            function fibRecursive(num) {
                recursiveCalls++;
                if (num <= 1) return num;
                return fibRecursive(num - 1) + fibRecursive(num - 2);
            }
            
            const recursiveResult = fibRecursive(n);
            const recursiveTime = performance.now() - startRecursive;
            
            // ÂãïÊÖãË¶èÂäÉÊñπÊ≥ï
            let dpCalls = 0;
            const startDP = performance.now();
            
            function fibDP(num) {
                const dp = [0, 1];
                for (let i = 2; i <= num; i++) {
                    dpCalls++;
                    dp[i] = dp[i - 1] + dp[i - 2];
                }
                return dp[num];
            }
            
            const dpResult = fibDP(n);
            const dpTime = performance.now() - startDP;
            
            // È°ØÁ§∫ÁµêÊûú
            document.getElementById('fibResult').textContent = `Fibonacci(${n}) = ${dpResult}`;
            document.getElementById('recursiveResult').innerHTML = 
                `ÊôÇÈñì: ${recursiveTime.toFixed(2)} ms<br>ÂëºÂè´Ê¨°Êï∏: ${recursiveCalls}`;
            document.getElementById('dpResult').innerHTML = 
                `ÊôÇÈñì: ${dpTime.toFixed(2)} ms<br>Ë®àÁÆóÊ¨°Êï∏: ${dpCalls}`;
            
            updateStepInfo(`ÂãïÊÖãË¶èÂäÉÊØîÈÅûËø¥Âø´‰∫Ü ${(recursiveTime / dpTime).toFixed(1)} ÂÄçÔºÅ`);
        }

        async function animateSwap(index1, index2) {
            const element1 = document.getElementById(`element-${index1}`);
            const element2 = document.getElementById(`element-${index2}`);
            
            if (!element1 || !element2) return;
            
            // Ê∑ªÂä†‰∫§ÊèõÂãïÁï´
            if (index1 < index2) {
                element1.classList.add('slide-right');
                element2.classList.add('slide-left');
            } else {
                element1.classList.add('slide-left');
                element2.classList.add('slide-right');
            }
            
            // Á≠âÂæÖÂãïÁï´ÂÆåÊàê
            await sleep(800);
            
            // Ê∏ÖÈô§ÂãïÁï´È°ûÂà•
            element1.classList.remove('slide-left', 'slide-right');
            element2.classList.remove('slide-left', 'slide-right');
        }
        
        async function animateInsert(fromIndex, toIndex) {
            const element = document.getElementById(`element-${fromIndex}`);
            if (!element) return;
            
            // Ê∑ªÂä†ÊèíÂÖ•ÂãïÁï´
            if (fromIndex > toIndex) {
                element.classList.add('moving-up');
            } else {
                element.classList.add('moving-down');
            }
            
            // Á≠âÂæÖÂãïÁï´ÂÆåÊàê
            await sleep(600);
            
            // Ê∏ÖÈô§ÂãïÁï´È°ûÂà•
            element.classList.remove('moving-up', 'moving-down');
        }

        async function sleep(ms) {
            return new Promise((resolve, reject) => {
                const checkPause = () => {
                    if (shouldStop) {
                        reject(new Error('STOPPED'));
                        return;
                    }
                    if (isPaused) {
                        setTimeout(checkPause, 100);
                        return;
                    }
                    setTimeout(resolve, ms);
                };
                checkPause();
            });
        }
    </script>
</body>
</html>
